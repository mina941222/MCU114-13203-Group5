<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <!-- App 功能 (完全符合老師圖片中要求): 網路功能 -->
    <uses-permission android:name="android.permission.INTERNET" />

    <!-- App 元件: Background Services / Broadcast Receiver (通知提醒) -->
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <!-- 適用於 Android 13 (API 33) 以上的通知權限 -->
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <!-- 確保服務能在背景執行 (API 28 以上要求) -->
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE"/>

    <!-- 確保服務能在 API 34+ 正確運行 -->
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE_SPECIAL_USE"/>


    <application
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.HealthyLife"
        tools:targetApi="31">

        <!-- 頁面 1: 登入 / 註冊頁 (LoginActivity) -->
        <activity
            android:name=".LoginActivity"
            android:exported="true"
            android:windowSoftInputMode="adjustPan">
            <intent-filter>
                <!-- 設為啟動頁面 -->
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <!-- 頁面 2: 今日紀錄頁 (DashboardActivity) - 首頁 -->
        <activity android:name=".DashboardActivity" />

        <!-- 頁面 3: 新增飲食/飲水頁 (AddMealActivity) -->
        <activity android:name=".AddMealActivity" />

        <!-- 頁面 4: 統計與分析頁 (StatsActivity) -->
        <activity android:name=".StatsActivity" />

        <!-- 頁面 5: AI 建議頁 (AIAdviceActivity) -->
        <activity android:name=".AIAdviceActivity" />

        <!-- 頁面 6: 回饋與設定頁 (FeedbackActivity) -->
        <activity android:name=".FeedbackActivity" />

        <!-- App 元件: Background Services (每日早上 8 點提醒) -->
        <service
            android:name=".ReminderService"
            android:enabled="true"
            android:exported="false"
            android:foregroundServiceType="specialUse"
            tools:targetApi="34">
            <!-- 服務類型聲明 (API 34+) -->
            <meta-data android:name="android.app.PROPERTY_SPECIAL_USE_FGS_SUBTYPE"
                android:value="daily_reminder"/>
        </service>

        <!-- App 元件: Broadcast Receiver (接收定時鬧鐘) -->
        <receiver android:name=".AlarmReceiver" android:exported="true" />

        <!-- App 元件: Broadcast Receiver (接收提醒廣播，重開機後重新設定通知) -->
        <receiver
            android:name=".BootReceiver"
            android:exported="true">
            <intent-filter>
                <!-- 接收開機廣播 -->
                <action android:name="android.intent.action.BOOT_COMPLETED" />
            </intent-filter>
        </receiver>

        <!-- Content Provider (不需要註冊，由 Room/ViewModel 模擬跨頁資料存取) -->

    </application>
</manifest>